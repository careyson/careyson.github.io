---
layout: post
title: "T-SQL查询进阶--基于列的逻辑表达式"
date: 2011-08-11
categories: blog
tags: [博客园迁移]
---

### **引言**

T-SQL不仅仅是一个用于查询数据库的语言，还是一个可以对数据进行操作的语言。基于列的CASE表达式就是其中一种,不像其他查询语句可以互相替代（比如用子查询实现的查询也可以使用Join实现），CASE表达式在控制基于列的逻辑大部分是无法替代的。下面文中会详细讲解CASE表达式。

### ****

### **简介**

****

基于列的逻辑表达式，其实就是CASE表达式.可以用在SELECT,UPDATE,DELETE,SET以及IN,WHERE,ORDER BY和HAVING子句之后。由于这里讲的是T-SQL查询，所以只说到CASE表达式在SELECT子句和ORDER BY子句中的使用。

CASE表达式实现的功能类似于编程语言中的IF…THEN…ELSE逻辑。只是CASE表达式在T-SQL中并不能控制T-SQL程序的流程，只是作为基于列的逻辑使用.

一个简单的CASE表达式如下：

我已经知道员工ID对应的姓名，我想获得员工ID，并将员工ID以姓名的方式展现出来，我不知道的员工ID则显示UNKNOW:
    
    
    [SELECT](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=SELECT&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [TOP](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=TOP&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 4 [CASE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=CASE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 1 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'CareySon'
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 2 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Jack'
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 3 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Tom'
    	[ELSE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=ELSE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'UNKNOW'
    	[END](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=END&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [AS](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=AS&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) NameList,EmployeeID
      [FROM](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=FROM&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [AdventureWorks].[HumanResources].[Employee]
      [ORDER](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=ORDER&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [BY](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=BY&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID

显示结果如下：

![image](https://cdn.jsdelivr.net/gh/careyson/careyson.github.io@main/assets/images/2011-08-11-t-sql/t-sql-201108111644502616.png)

上面代码中，CASE后面跟选择的列名，后面的WHEN所取得值都为EmployeeID这一列，THEN后面的值为对应前面WHEN后面列中，实际在结果中显示的值。

CASE表达式实际情况可以分为两种: 

CASE简单表达式\(CASE Simple Expression\):将某个表达式与一组简单表达式进行比较以确定结果。

CASE 搜索表达式\(CASE Searched Expression\):计算一组布尔表达式以确定结果。

下面会按照这两种CASE表达式来阐述

#### **CASE简单表达式\(CASE Simple Expression\)**

在CASE简单表达式中,整个表达式只会取一列的值做相应的判断，上面那个查询例子就是一个CASE简单表达式,可以用下图表示：

[![image](https://cdn.jsdelivr.net/gh/careyson/careyson.github.io@main/assets/images/2011-08-11-t-sql/t-sql-201108111644571923.png)](http://images.cnblogs.com/cnblogs_com/CareySon/201108/201108111644514502.png)

CASE表达式也可以用这样的写法:
    
    
    [SELECT](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=SELECT&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [TOP](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=TOP&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 4 NameList=[CASE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=CASE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 1 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'CareySon'
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 2 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Jack'
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 3 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Tom'
    	[ELSE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=ELSE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'UNKNOW'
    	[END](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=END&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99),EmployeeID
      [FROM](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=FROM&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [AdventureWorks].[HumanResources].[Employee]
      [ORDER](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=ORDER&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [BY](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=BY&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID

上面代码和前面代码所达到的效果是一模一样的，从这个代码可以看出，CASE表达式的结果实际上只局限在一列当中，这也是为什么CASE表达式是“基于列的逻辑表达式”

因为CASE表达式的值只局限在一列当中，所以THEN后面的值数据类型必须相同，或者兼容，否则就会报错。

在上面语句中，还有一个可选的“ELSE”语句，这个语句可以省略，但最好的做法是保留ELSE，否则不在匹配值范围内的所有值都会为“NULL”。

#### **CASE搜索表达式\(CASE Searched****Expression\)**

**** 与CASE简单表达式不同，CASE搜索表达式提供了更强大的功能,CASE搜索表达式不仅可以使用更复杂的逻辑表达式，并且还能根据多列中的数据确定所显示列的值。与上面CASE简单表达式等效的CASE搜索表达式为:
    
    
    [SELECT](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=SELECT&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [TOP](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=TOP&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 4 NameList=[CASE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=CASE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID=1 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'CareySon'
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID=1 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Jack'
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID=3 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Tom'
    	[ELSE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=ELSE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'UNKNOW'
    	[END](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=END&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99),EmployeeID
      [FROM](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=FROM&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [AdventureWorks].[HumanResources].[Employee]
      [ORDER](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=ORDER&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [BY](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=BY&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID

CASE搜索表达式更复杂的应用比如:

公司规定每个人病假或者休假每年都不应该超过30个小时，现在我想取得所有男性员工的ID，其中员工病假或者是休假任意一项超过了30个小时，标记为“Exceed the time”,两项都不超过30个小时的，标记为“Not Exceed the time”
    
    
    [SELECT](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=SELECT&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID,
          [CASE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=CASE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 
          [WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) VacationHours>30 [AND](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=AND&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) Gender='M' [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Exceed The Time'
          [WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) SickLeaveHours>30 [AND](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=AND&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) Gender='M' [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Exceed The Time'
          [ELSE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=ELSE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Not Exceed The Time'
          [END](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=END&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [AS](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=AS&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) Condition
      [FROM](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=FROM&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [AdventureWorks].[HumanResources].[Employee]

查询结果如下:

[![image](https://cdn.jsdelivr.net/gh/careyson/careyson.github.io@main/assets/images/2011-08-11-t-sql/t-sql-201108111646225450.png)](http://images.cnblogs.com/cnblogs_com/CareySon/201108/201108111644587397.png)

上面可以看到，搜索表达式一列的WHEN表达式可以取自不同列，甚至是不同列之间的运算（比如上面可以取WHEN VacationHours+SickLeaveHours>60）,这大大增强了CASE表达式的功能，因为CASE搜索表达式可以完全实现CASE简单表达式所能实现的功能，我个人认为所有的CASE表达式都应该写成CASE搜索表达式的形式。

还有要注意WHEN…THEN是以先后顺序出现,当第一个WHEN后面的表达式为FALSE时，则会去看第二个WHEN后的表达式，依次类推。当第一个WHEN后的表达式为TRUE时，则取第一个THEN后面的值，即使第二个WHEN表达式也为TRUE。

例如还是第一个例子:我已经知道员工ID对应的姓名，我想获得员工ID，并将员工ID以姓名的方式展现出来，我不知道的员工ID则显示UNKNOW:
    
    
    [SELECT](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=SELECT&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99)  NameList=[CASE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=CASE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 
    
    
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID=1 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'CareySon'
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID=1 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Jack'
    	[WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID=3 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'Tom'
    	[ELSE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=ELSE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) 'UNKNOW'
    	[END](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=END&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99),EmployeeID
      [FROM](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=FROM&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [AdventureWorks].[HumanResources].[Employee]
      [ORDER](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=ORDER&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [BY](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=BY&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) EmployeeID

结果如下：

[![image](https://cdn.jsdelivr.net/gh/careyson/careyson.github.io@main/assets/images/2011-08-11-t-sql/t-sql-201108111646274299.png)](http://images.cnblogs.com/cnblogs_com/CareySon/201108/201108111646235351.png)

#### **CASE表达式在ORDER BY中的使用**

CASE表达式在ORDER BY中可以将排序结果分类，使符合某些条件的行\(Row\)采用一种排序方式，符合另一种条件的行采用另一种排序方式：

比如:我想查看省份ID为8和9的员工的地址，当省份ID为9时，按照AddressID降序排列，当省份ID为8时，按照AddressID升序排列
    
    
    [SELECT](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=SELECT&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [AddressID]
          ,[AddressLine1]
          ,[City]
          ,[StateProvinceID]
          [FROM](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=FROM&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [AdventureWorks].[Person].[Address]
    [WHERE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHERE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) StateProvinceID=9 [OR](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=OR&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) StateProvinceID=8
    [ORDER](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=ORDER&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [BY](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=BY&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99)  
             [CASE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=CASE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) StateProvinceID=9 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) AddressID [END](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=END&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [DESC](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=DESC&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99),
             [CASE](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=CASE&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) [WHEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=WHEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) StateProvinceID=8 [THEN](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=THEN&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99) AddressID [END](http://search.microsoft.com/default.asp?so=RECCNT&siteid=us%2Fdev&p=1&nq=NEW&qu=END&IntlSearch=&boolean=PHRASE&ig=01&i=09&i=99)

结果如下：

[![image](https://cdn.jsdelivr.net/gh/careyson/careyson.github.io@main/assets/images/2011-08-11-t-sql/t-sql-201108111649008393.png)](http://images.cnblogs.com/cnblogs_com/CareySon/201108/201108111648594589.png)

注意这里，每一条排序规则都要写一个单独的CASE表达式，前面文章说了，因为CASE表达式是基于列的，一个CASE表达式只能返回一个值，所以基于多少个值排序，则需要多少个CASE表达式

#### 

#### **总结**

文章讲述了CASE表达式在SELECT子句中和ORDER BY子句中的使用，CASE表达式又进一步分为CASE简单表达式和CASE搜索表达式。掌握使用CASE表达式可以使程序员将一部分需要在程序中的业务逻辑移到数据库中。掌握CASE表达式是深入学习T-SQL查询必不可少的。
